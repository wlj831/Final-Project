{
  "hash": "ed669604e8f802e6507d2e5907cdb0db",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Wrangling of Final Project\"\nauthor: \"William Jackson\"\ndate: \"2025-05-15 15:46:07\"\nformat: \n  html:\n    theme: darkly\n    toc: true\n    toc-location: right\n    toc-depth: 4\n    code-fold: false\n    code-line-numbers: true\n    code-link: true\n    number-sections: false\n    embed-resources: true\n    df-print: paged\nexecute: \n  freeze: auto\n  echo: true\n  warning: false\n  error: false\n---\n\n\n\n## Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n:::\n\n\n\n## Upload the CSV File\n\n> ### This file will be uploaded from the original CSV files, one will be the data set that will be used for a geographical representation at a national level and then a local level. I will look at specifically areas within the Los Angeles/Orange County for more relevant information.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the raw file URL from GitHub\nurl <- \"https://raw.githubusercontent.com/wlj831/Raw-Data-GBA-5910-/refs/heads/main/Cleaned%20Raw%20Data%20File.csv\"\n\n# Load the data directly into R\ndata <- read.csv(url)\n\n# View the first few rows of the data\nhead(data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Severity\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"City\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"County\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"State\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Zipcode\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Country\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Timezone\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2\",\"2\":\"Zachary\",\"3\":\"East Baton Rouge\",\"4\":\"LA\",\"5\":\"70791-4610\",\"6\":\"US\",\"7\":\"US/Central\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"Sterling\",\"3\":\"Loudoun\",\"4\":\"VA\",\"5\":\"20164-2813\",\"6\":\"US\",\"7\":\"US/Eastern\",\"_rn_\":\"2\"},{\"1\":\"2\",\"2\":\"Lompoc\",\"3\":\"Santa Barbara\",\"4\":\"CA\",\"5\":\"93436\",\"6\":\"US\",\"7\":\"US/Pacific\",\"_rn_\":\"3\"},{\"1\":\"2\",\"2\":\"Austin\",\"3\":\"Mower\",\"4\":\"MN\",\"5\":\"55912\",\"6\":\"US\",\"7\":\"US/Central\",\"_rn_\":\"4\"},{\"1\":\"2\",\"2\":\"Bakersfield\",\"3\":\"Kern\",\"4\":\"CA\",\"5\":\"93305-2649\",\"6\":\"US\",\"7\":\"US/Pacific\",\"_rn_\":\"5\"},{\"1\":\"2\",\"2\":\"Peabody\",\"3\":\"Essex\",\"4\":\"MA\",\"5\":\"01960-4275\",\"6\":\"US\",\"7\":\"US/Eastern\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Load data from GitHub using base R\ndata_traffic <- read.csv(\"https://raw.githubusercontent.com/wlj831/Raw-Data-GBA-5910-/refs/heads/main/Cleaned%20Road%20Traffic%20Accidents.csv\")\n\n# View first few rows\nhead(data_traffic)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Age_band_of_driver\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Sex_of_driver\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Educational_level\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Vehicle_driver_relation\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Driving_experience\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Lanes_or_Medians\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Types_of_Junction\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Road_surface_type\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Light_conditions\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Weather_conditions\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Type_of_collision\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Vehicle_movement\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Pedestrian_movement\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Cause_of_accident\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Accident_severity\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"18-30\",\"2\":\"Male\",\"3\":\"Above high school\",\"4\":\"Employee\",\"5\":\"1-2yr\",\"6\":\"Unknown\",\"7\":\"No junction\",\"8\":\"Asphalt roads\",\"9\":\"Daylight\",\"10\":\"Normal\",\"11\":\"Collision with roadside-parked vehicles\",\"12\":\"Going straight\",\"13\":\"Not a Pedestrian\",\"14\":\"Moving Backward\",\"15\":\"2\",\"_rn_\":\"1\"},{\"1\":\"31-50\",\"2\":\"Male\",\"3\":\"Junior high school\",\"4\":\"Employee\",\"5\":\"Above 10yr\",\"6\":\"Undivided Two way\",\"7\":\"No junction\",\"8\":\"Asphalt roads\",\"9\":\"Daylight\",\"10\":\"Normal\",\"11\":\"Vehicle with vehicle collision\",\"12\":\"Going straight\",\"13\":\"Not a Pedestrian\",\"14\":\"Overtaking\",\"15\":\"2\",\"_rn_\":\"2\"},{\"1\":\"18-30\",\"2\":\"Male\",\"3\":\"Junior high school\",\"4\":\"Employee\",\"5\":\"1-2yr\",\"6\":\"other\",\"7\":\"No junction\",\"8\":\"Asphalt roads\",\"9\":\"Daylight\",\"10\":\"Normal\",\"11\":\"Collision with roadside objects\",\"12\":\"Going straight\",\"13\":\"Not a Pedestrian\",\"14\":\"Changing lane to the left\",\"15\":\"1\",\"_rn_\":\"3\"},{\"1\":\"18-30\",\"2\":\"Male\",\"3\":\"Junior high school\",\"4\":\"Employee\",\"5\":\"5-10yr\",\"6\":\"other\",\"7\":\"Y Shape\",\"8\":\"Earth roads\",\"9\":\"Darkness - lights lit\",\"10\":\"Normal\",\"11\":\"Vehicle with vehicle collision\",\"12\":\"Going straight\",\"13\":\"Not a Pedestrian\",\"14\":\"Changing lane to the right\",\"15\":\"2\",\"_rn_\":\"4\"},{\"1\":\"18-30\",\"2\":\"Male\",\"3\":\"Junior high school\",\"4\":\"Employee\",\"5\":\"2-5yr\",\"6\":\"other\",\"7\":\"Y Shape\",\"8\":\"Asphalt roads\",\"9\":\"Darkness - lights lit\",\"10\":\"Normal\",\"11\":\"Vehicle with vehicle collision\",\"12\":\"Going straight\",\"13\":\"Not a Pedestrian\",\"14\":\"Overtaking\",\"15\":\"2\",\"_rn_\":\"5\"},{\"1\":\"31-50\",\"2\":\"Male\",\"3\":\"Unknown\",\"4\":\"Unknown\",\"5\":\"Unknown\",\"6\":\"Unknown\",\"7\":\"Y Shape\",\"8\":\"Unknown\",\"9\":\"Daylight\",\"10\":\"Normal\",\"11\":\"Vehicle with vehicle collision\",\"12\":\"U-Turn\",\"13\":\"Not a Pedestrian\",\"14\":\"Overloading\",\"15\":\"2\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Data Cleaning and Geographical Map\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(maps)      # For state map data\nlibrary(viridis)   # Optional: for color scales, or use red-blue as specified\n\n# Clean the data\nClean_Data_Geography <- na.omit(data)\n\n# Keep only State and County\nState_County_Only <- Clean_Data_Geography[, c(\"State\", \"County\")]\n\n# Count accidents by state\naccidents_by_state <- State_County_Only %>%\n  group_by(State) %>%\n  summarize(accident_count = n())\n\n# Make state names lowercase to match map data\naccidents_by_state$region <- tolower(accidents_by_state$State)\n\n# Get map data for US states\nstates_map <- map_data(\"state\")\n\n# Filter out Alaska and Hawaii\nstates_map <- states_map %>% \n  filter(!(region %in% c(\"alaska\", \"hawaii\")))\n\n# Convert state abbreviations (e.g., \"CA\") to full state names\naccidents_by_state$region <- tolower(state.name[match(accidents_by_state$State, state.abb)])\n\n\n# Join accident data with map data\nmap_data_joined <- left_join(states_map, accidents_by_state, by = \"region\")\n\n# --- Plot with custom background ---\nggplot(map_data_joined, aes(long, lat, group = group, fill = accident_count)) +\n  geom_polygon(color = \"white\", size = 0.2) +\n  scale_fill_gradient(low = \"blue\", high = \"red\", na.value = \"gray90\") +\n  labs(title = \"Car Accidents by State (Lower 48)\", fill = \"Accidents\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.background = element_rect(fill = \"#e6f2ff\", color = NA),      # Light blue\n    panel.background = element_rect(fill = \"#f7f7f7\", color = NA),     # Soft gray map area\n    legend.background = element_rect(fill = \"#e6f2ff\", color = NA),    # Match plot bg\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    axis.title = element_blank(),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## Cities in Orange and LA County wih Most Car Accidents\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Step 1: Filter for LA and Orange Counties\nla_oc_data <- Clean_Data_Geography %>%\n  filter(State == \"CA\", County %in% c(\"Los Angeles\", \"Orange\"))\n\n# Step 2: Count accidents by City\naccidents_by_city <- la_oc_data %>%\n  group_by(City) %>%\n  summarize(accident_count = n()) %>%\n  arrange(desc(accident_count))\n\n# Step 3: Select the top 20 cities with the most accidents\ntop_20_cities <- accidents_by_city %>%\n  top_n(20, wt = accident_count)\n\n# Step 4: Plot the bar chart\nggplot(top_20_cities, aes(x = reorder(City, -accident_count), y = accident_count, fill = accident_count)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  labs(title = \"Top 20 Cities by Accidents in LA & Orange Counties\", x = \"City\", y = \"Number of Accidents\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n## Top 10 Cities with Car Accidents\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Step 1: Filter for the lower 48 states (excluding Alaska and Hawaii)\nlower_48_data <- Clean_Data_Geography %>%\n  filter(State != \"AK\", State != \"HI\")\n\n# Step 2: Count accidents by City\naccidents_by_city <- lower_48_data %>%\n  group_by(City) %>%\n  summarize(accident_count = n()) %>%\n  arrange(desc(accident_count))\n\n# Step 3: Select the top 10 cities with the most accidents\ntop_10_cities <- accidents_by_city %>%\n  top_n(10, wt = accident_count)\n\n# Step 4: Plot the bar chart\nggplot(top_10_cities, aes(x = reorder(City, -accident_count), y = accident_count, fill = accident_count)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  labs(title = \"Top 10 Cities by Accidents in the Lower 48 States\", x = \"City\", y = \"Number of Accidents\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Analysis of location of Car Accidents\n\n> Now we will analyze if there is any causation on the fact that certain types of intersections places on the road have higher frequency of accidents. We will also analysis the severity of these accidents\n\n### Loading Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# View all column names in the dataset\ncolnames(data_traffic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Age_band_of_driver\"      \"Sex_of_driver\"          \n [3] \"Educational_level\"       \"Vehicle_driver_relation\"\n [5] \"Driving_experience\"      \"Lanes_or_Medians\"       \n [7] \"Types_of_Junction\"       \"Road_surface_type\"      \n [9] \"Light_conditions\"        \"Weather_conditions\"     \n[11] \"Type_of_collision\"       \"Vehicle_movement\"       \n[13] \"Pedestrian_movement\"     \"Cause_of_accident\"      \n[15] \"Accident_severity\"      \n```\n\n\n:::\n\n```{.r .cell-code}\n# View all unique values in 'Types_of_Junction'\nunique(data_traffic$Types_of_Junction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"No junction\" \"Y Shape\"     \"Crossing\"    \"O Shape\"     \"Other\"      \n[6] \"Unknown\"     \"T Shape\"     \"X Shape\"    \n```\n\n\n:::\n\n```{.r .cell-code}\n# Load the necessary libraries\nlibrary(dplyr)\n\n# Count the frequency of each 'Types_of_Junction'\njunction_counts <- data_traffic %>%\n  group_by(Types_of_Junction) %>%\n  summarise(Count = n())\n\n# View the counted data_traffic\nprint(junction_counts)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 2\n  Types_of_Junction Count\n  <chr>             <int>\n1 Crossing           2177\n2 No junction        3837\n3 O Shape             164\n4 Other               445\n5 T Shape              60\n6 Unknown            1078\n7 X Shape              12\n8 Y Shape            4543\n```\n\n\n:::\n\n```{.r .cell-code}\n# Load ggplot2 for plotting\nlibrary(ggplot2)\n\n# Create a bar plot of junction counts\nggplot(junction_counts, aes(x = Types_of_Junction, y = Count)) +\n  geom_bar(stat = \"identity\", fill = \"green\") +\n  labs(title = \"Accidents by Type of Junction\", \n       x = \"Type of Junction\", \n       y = \"Number of Accidents\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the necessary libraries\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Group the data_traffic by Types_of_Junction and Accident_severity\nseverity_by_junction <- data_traffic %>%\n  group_by(Types_of_Junction, Accident_severity) %>%\n  summarise(Accident_Count = n(), .groups = \"drop\")  # Remove grouping after summarization\n\n# Create a bar graph to visualize the accident severity by junction type\nggplot(severity_by_junction, aes(x = Types_of_Junction, y = Accident_Count, fill = factor(Accident_severity))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(title = \"Accident Severity by Type of Junction\",\n       x = \"Type of Junction\", \n       y = \"Number of Accidents\",\n       fill = \"Accident Severity\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n## Chi-Square Test of Indepedence \n> This will help test wehater accident severity is statiscally independent of the junction type - i.e. whether certain junctions tend to have more severe accidents. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a contingency table\ncontingency_table <- table(data_traffic$Types_of_Junction, data_traffic$Accident_severity)\n\n# Perform Chi-Square Test\nchisq_test <- chisq.test(contingency_table)\n\n# View the result\nchisq_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  contingency_table\nX-squared = 57.181, df = 14, p-value = 3.639e-07\n```\n\n\n:::\n:::\n\n\n\n\n## Proportional Heatmap\n> Visualization of the proportions of accident severity per junction type which types are skewed toward higher severity. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Summarize the data\nbubble_data <- data_traffic %>%\n  group_by(Types_of_Junction, Accident_severity) %>%\n  summarise(Count = n(), .groups = \"drop\")\n\n# Custom red-blue gradient (from blue -> white -> red)\ncustom_colors <- c(\"#08306B\", \"#2171B5\", \"#6BAED6\", \"#F7F7F7\", \"#FC9272\", \"#CB181D\", \"#67000D\")\n\n# Plot with enhanced color and size\nggplot(bubble_data, aes(x = Types_of_Junction, y = factor(Accident_severity), size = Count, fill = Count)) +\n  geom_point(shape = 21, color = \"black\", alpha = 0.8) +\n  scale_size(range = c(4, 16)) +\n  scale_fill_gradientn(colors = custom_colors) +\n  labs(\n    title = \"Bubble Heatmap: Accident Severity by Junction Type\",\n    x = \"Type of Junction\",\n    y = \"Accident Severity\",\n    size = \"Number of Accidents\",\n    fill = \"Number of Accidents\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"right\",\n    plot.title = element_text(face = \"bold\", size = 16)\n  )\n```\n\n::: {.cell-output-display}\n![](Jackson,-William-Group-3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Jackson,-William-Group-3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}